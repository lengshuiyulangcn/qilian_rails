<div class="well">
  <h3 class="page-header">
    修改个人信息
  </h3>
  <div class="row">
    <div class="col-lg-12">
      <%= form_for user do |f| %>
        <div class="form-group">
            <label>姓</label>
            <%=f.text_field :family_name, value: user.family_name, required: true  %>
            <%=f.hidden_field :id, value: user.id, class: 'form-control', required: true %>
            <label>名</label>
            <%=f.text_field :given_name, value: user.given_name, required: true  %>
        </div>
        <div class="form-group">
            <label>性别</label>
            <%=f.select :gender, [["男", "男"], ["女", "女"]] %>
          </div>

        <div class="form-group">
            <label>生日</label>
            <%=f.date_select :birthday, use_month_numbers: :true, start_year: 1980, end_year: 2000 %>
        </div>
        <div class="form-group">
          <label for="PostImage">添加头像</label>
            <%= f.file_field :image, id: "eyecatch_upload", onchange: "previewFile()" %><br />
            <%= image_tag  user.image, id: "heyecatch_url", style: "width: 140px; height: 140px;"%>
        </div>

        <div class="form-group">
          <label>联系电话</label>
          <%=f.text_field :phone, value: user.phone, class: 'form-control',required: true  %>
        </div>
        <div class="form-group">
          <label>邮箱</label>
          <%=f.email_field :email, value: user.email, class: 'form-control'%>
        </div>

      <div class="form-group">
        <label>学校(或最终毕业学校)</label>
          <%=f.text_field :school, value: user.school, class: 'form-control', required: true  %>
      </div>

      <div class="form-group">
        <label for="PostImage">专业</label>
          <%=f.text_field :major, value: user.major, class: 'form-control', required: true  %>
      </div>


      <div class="form-group">
        <label class="control-label">工作信息(可选)</label>
          <%=f.text_field :job, value: user.job, class: 'form-control' %>
      </div>
      <div class="form-group">
        <label class="control-label">微信号(可选)</label>
          <%=f.text_field :wechat, value: user.wechat, class: 'form-control' %>
        </div>
      <div class="form-group">
        <label class="control-label">lineID(可选)</label>
            <%=f.text_field :line, value: user.line, class: 'form-control' %>
      </div>
      <% if current_user.role == 'admin' %>
        <label>用户身份变更</label><br>
        <%=f.select :role, [["学生", "student"], ["教师", "teacher"],["管理员", "admin"]] %>
      <% end %>
      <div class="form-group">
        <div class="col-lg-10 col-lg-offset-2">
          <button type="submit" class="btn btn-primary">提交表单</button>
        </div>
      </div>
        <% end %>
    </div>
  </div>
</div>
<script>
function previewFile() {
  var preview = document.getElementById('eyecatch_url');
  var file    = document.getElementById('eyecatch_upload').files[0];
  var reader  = new FileReader();

  reader.onloadend = function () {
    preview.src = reader.result;
  }

  if (file) {
    reader.readAsDataURL(file);
  } else {
    preview.src = "";
  }
}
</script>

